{"version":3,"file":"eVue.js","sources":["../eVue-03/js/dep.js","../eVue-03/js/observer.js","../eVue-03/js/watcher.js","../eVue-03/js/compile.js","../eVue-03/js/vnode.js","../eVue-03/js/evue.js","../eVue-03/index.js"],"sourcesContent":["let depid = 0;\n\nexport class Dep {\n    constructor(options) {\n        this.id = depid++;\n        this.key = options.key ? options.key : \"\";\n        this.subs = [];\n    }\n    addSub(watcherInstance) {\n        this.subs.push(watcherInstance);\n    }\n    removeSub(watcherInstance) {\n        if (this.subs.indexOf(watcherInstance) !== -1) {\n            this.subs.splice(index, 1);\n        }\n    }\n    depend() {\n        // Dep.target 指向的是 watcherInstance\n        Dep.target && Dep.target.addDep(this);\n    }\n    notify() {\n        const subs = this.subs.slice();\n        subs.forEach((sub) => {\n            sub.update();\n        });\n    }\n}\n\nDep.target = null;\n","import { Dep } from \"./dep\";\n\nexport function observer(data) {\n    if (data !== null && typeof data === \"object\") {\n        return new Observer(data);\n    }\n    return;\n}\n\nexport class Observer {\n    constructor(data) {\n        this.data = data;\n        this.walk(data);\n    }\n    walk(data) {\n        Object.entries(data).forEach(([key, value], index) => {\n            this.convert(key, value);\n        });\n    }\n    convert(key, val) {\n        this.defineReactive(this.data, key, val);\n    }\n    defineReactive(data, key, value) {\n        const dep = new Dep({ key });\n        observer(value);\n        Object.defineProperty(data, key, {\n            enumerable: true,\n            configurable: true,\n            get: function () {\n                if (Dep.target) {\n                    dep.depend();\n                }\n                return value;\n            },\n            set: function (newValue) {\n                if (value === newValue) return;\n                value = newValue;\n                observer(newValue);\n                dep.notify();\n            },\n        });\n    }\n}\n","import { Dep } from \"./dep\";\nexport class Watcher {\n    constructor(vm, expOrFn, cb, options) {\n        this.vm = vm;\n        // lazy 表示一种固定描述，不可改变，表示这个 watcher 需要缓存\n        this.lazy = options && options.lazy;\n        // dirty 表示缓存是否可用，如果为 true，表示缓存脏了，需要重新计算，否则不用\n        this.dirty = options && options.lazy;\n        this.expOrFn = expOrFn;\n        this.cb = cb;\n        this.depIds = {};\n        this.deps = [];\n        if (typeof expOrFn === \"function\") {\n            this.getter = expOrFn;\n        } else {\n            this.getter = this.parseGetter(expOrFn.trim());\n        }\n        this.value = this.lazy ? undefined : this.get();\n    }\n    update() {\n        let value = this.get();\n        let oldValue = this.value;\n        // 当通知 computed 更新的时候，就只是 把 dirty 设置为 true，从而 读取 comptued 时，便会调用 evalute 重新计算\n        if (this.lazy) this.dirty = true;\n        if (value !== oldValue) {\n            this.value = value;\n            this.cb.call(this.vm, value, oldValue);\n        }\n    }\n    addDep(dep) {\n        if (!this.depIds.hasOwnProperty(dep.id)) {\n            dep.addSub(this);\n            this.depIds[dep.id] = dep;\n            this.deps.push(dep);\n        }\n    }\n    get() {\n        Dep.target = this;\n        const value = this.getter.call(this.vm, this.vm);\n        Dep.target = null;\n        return value;\n    }\n    depend() {\n        let i = this.deps.length;\n        while (i--) {\n            this.deps[i].depend();\n        }\n    }\n    evaluate() {\n        this.value = this.get();\n        // 执行完更新函数之后，立即重置标志位\n        this.dirty = false;\n    }\n    parseGetter(exp) {\n        if (/[^\\w.$]/.test(exp)) return;\n        var exps = exp.split(\".\");\n        return function (obj) {\n            for (var i = 0, len = exps.length; i < len; i++) {\n                if (!obj) return;\n                obj = obj[exps[i]];\n            }\n            return obj;\n        };\n    }\n}\n","import { Watcher } from \"./watcher\";\n\n\nexport class Compile {\n    constructor(el, vm) {\n        this.$vm = vm;\n        this.$el = el.nodeType === 1 ? el : document.querySelector(el);\n        if (this.$el) {\n            this.$fragment = this.nodeToFragment(this.$el);\n            this.compile(this.$fragment);\n            this.$el.appendChild(this.$fragment);\n        }\n    }\n    nodeToFragment(el) {\n        let fragment = document.createDocumentFragment();\n        let child;\n        while ((child = el.firstChild)) {\n            fragment.appendChild(child);\n        }\n        return fragment;\n    }\n    compile(fragment) {\n        let childNodes = fragment.childNodes;\n        let _this = this;\n        Array.prototype.slice.call(childNodes).forEach((node) => {\n            let text = node.textContent;\n            let reg = /\\{\\{(.*)\\}\\}/; // 表达式文本\n\n            if (node.nodeType === 1) {\n                _this.compileElement(node);\n            }\n            if (node.nodeType === 3 && reg.test(text)) {\n                compileUtil.text(node, this.$vm, RegExp.$1);\n            }\n            if (node.childNodes && node.childNodes.length) {\n                _this.compile(node);\n            }\n        });\n    }\n    compileElement(element) {\n        const attrs = element.attributes;\n        const _this = this;\n        Array.prototype.slice.call(attrs).forEach((attr) => {\n            let attrName = attr.name;\n            let attrValue = attr.value;\n            // 如 <span v-text=\"content\"></span> 中指令为 v-text\n            if (attrName.indexOf(\"v-\") === 0) {\n                let dir = attrName.substring(2);\n                // 绑定methods\n                if (dir.indexOf(\"on\") === 0) {\n                    compileUtil.eventHandler(element, _this.$vm, attrValue, dir);\n                } else {\n                    compileUtil[dir] && compileUtil[dir](element, _this.$vm, attrValue);\n                }\n                element.removeAttribute(attrName);\n            }\n        });\n    }\n}\n\nconst compileUtil = {\n    text: function (node, vm, exp) {\n        this.bind(node, vm, exp, \"text\");\n    },\n    html: function (node, vm, exp) {\n        this.bind(node, vm, exp, \"html\");\n    },\n    model: function (node, vm, exp) {\n        this.bind(node, vm, exp, \"model\");\n        let _this = this;\n        let val = _this._getVMVal(vm, exp);\n        node.addEventListener(\"input\", function (e) {\n            let newValue = e.target.value;\n            if (val === newValue) {\n                return;\n            }\n\n            _this._setVMVal(vm, exp, newValue);\n            val = newValue;\n        });\n    },\n    class: function (node, vm, exp) {\n        this.bind(node, vm, exp, \"class\");\n    },\n    bind: function (node, vm, exp, dir) {\n        let updaterFn = updater[dir + \"Updater\"];\n\n        updaterFn && updaterFn(node, this._getVMVal(vm, exp, dir));\n\n        new Watcher(vm, exp, function (value, oldValue) {\n            updaterFn && updaterFn(node, value, oldValue);\n        });\n    },\n    eventHandler: function (node, vm, exp, dir) {\n        let eventType = dir.split(\":\")[1];\n        let fn = vm.options.methods && vm.options.methods[exp];\n\n        if (eventType && fn) {\n            node.addEventListener(eventType, fn.bind(vm), false);\n        }\n    },\n    _getVMVal: function (vm, exp, dir) {\n        let val = vm;\n        exp.split(\".\").forEach(function (k) {\n            val = val[k.trim()];\n        });\n        return val;\n    },\n\n    _setVMVal: function (vm, exp, value) {\n        let val = vm;\n        exp = exp.split(\".\");\n        exp.forEach(function (k, i) {\n            // 非最后一个key，更新val的值\n            if (i < exp.length - 1) {\n                val = val[k];\n            } else {\n                val[k] = value;\n            }\n        });\n    },\n};\n\nconst updater = {\n    textUpdater: function (node, value) {\n        node.textContent = typeof value == \"undefined\" ? \"\" : value;\n    },\n    htmlUpdater: function (node, value) {\n        node.innerHTML = typeof value == \"undefined\" ? \"\" : value;\n    },\n    classUpdater: function (node, value, oldValue) {\n        let className = node.className;\n        className = className.replace(oldValue, \"\").replace(/\\s$/, \"\");\n        let space = className && String(value) ? \" \" : \"\";\n        node.className = className + space + value;\n    },\n    modelUpdater: function (node, value, oldValue) {\n        node.value = typeof value == \"undefined\" ? \"\" : value;\n    },\n};\n","function Vnode(tag, data, children, text, element) {\n    this.tag = tag; // 标签名\n    this.data = data; // 存储节点的属性，class，style 等\n    this.children = children; // 子元素\n    this.text = text; // 文本内容\n    this.element = element; // Dom 节点\n}\n\nexport function createVnode(tag, data, children) {\n    return new Vnode(tag, data, normalizeChildren(children), undefined, undefined);\n}\n\nexport function createTextNode(val) {\n    return new Vnode(undefined, undefined, undefined, String(val));\n}\n\nexport function emptyNodeAt(elm) {\n    return new Vnode(elm.tagName.toLowerCase(), {}, [], undefined, elm);\n}\n\n// 生成VNode 的时候，并不存在真实 DOM,element 会在需要创建DOM 时完成赋值，具体函数在 createElement 中\nexport function createElement(vnode) {\n    if (!vnode) return;\n    const { tag, data, children } = vnode;\n    // tag是正常html标签\n    if (tag) {\n        vnode.element = document.createElement(tag);\n        if (data.attrs) {\n            for (let key in data.attrs) {\n                vnode.element.setAttribute(key, data.attrs[key]);\n            }\n        }\n        if (children) {\n            createChildren(vnode, children);\n        }\n    } else {\n        vnode.element = document.createTextNode(vnode.text);\n    }\n    return vnode.element;\n}\n\nfunction normalizeChildren(children) {\n    if (typeof children === \"string\") {\n        return [createTextNode(children)];\n    }\n    return children;\n}\n\nfunction createChildren(vnode, children) {\n    const l = children.length;\n    for (let index = 0; index < l; index++) {\n        vnode.element.appendChild(createElement(children[index]));\n    }\n}\n\nexport function sameVnode(vnode1, vnode2) {\n    return vnode1.tag === vnode2.tag;\n}\n","import { observer } from \"./observer\";\nimport { Compile } from \"./compile\";\nimport { Watcher } from \"./watcher\";\nimport { emptyNodeAt, createElement, sameVnode } from \"./vnode\";\nimport { Dep } from \"./dep\";\n\nexport class EVue {\n    constructor(options) {\n        this.options = options || {};\n        this.data = options.data;\n        this.el = options.el || \"body\";\n        this.initState(); // 初始化data,method,computed,watch\n        this.$mount(document.getElementById(\"render\"));\n        callHook(this, \"beforeMount\");\n        this._isMounted = true;\n        this.$compile = new Compile(this.el, this);\n        callHook(this, \"mounted\");\n    }\n    initState() {\n        const vm = this;\n        const ops = vm.options;\n        this.initLifecycle(vm);\n        callHook(vm, \"beforeCreate\");\n        ops.data && vm.initData();\n        ops.methods && vm.initMethods();\n        ops.computed && vm.initComputed();\n        callHook(vm, \"created\");\n    }\n    initData() {\n        const vm = this;\n        const data = vm.options.data;\n        // 通过Object.defineProperty 实现 vm.xxx -> vm._data.xxx\n        Object.keys(data).forEach(function (key) {\n            vm.$proxyData(key);\n        });\n        observer(this.data);\n    }\n    initMethods() {\n        const vm = this;\n        const methods = vm.options.methods;\n        for (let key in methods) {\n            vm[key] = methods[key].bind(vm);\n        }\n    }\n    initComputed() {\n        const vm = this;\n        const computed = vm.options.computed;\n        for (let key in computed) {\n            const userDef = computed[key]; // 获取用户定义的属性\n            vm.defineComputed(vm, key, userDef);\n        }\n    }\n    defineComputed(vm, key, userDef) {\n        const def = { enumerable: true, configurable: true };\n        def.get = makeComputedGetter(userDef, vm);\n        def.set = userDef.set ? userDef.set : function () {};\n        Object.defineProperty(vm, key, def);\n    }\n    initLifecycle(vm) {\n        vm._isMounted = false;\n        vm._isDestroyed = false;\n        vm._isBeingDestroyed = false;\n    }\n    $mount(element) {\n        const vm = this;\n        const vnode = vm.render();\n        vm.$el = element;\n        vm.update(vnode);\n    }\n    update(vnode) {\n        const vm = this;\n        const prevVnode = vm._vnode;\n        vm._vnode = vnode;\n        vm._isMounted && callHook(vm, \"beforeUpdate\");\n\n        if (!prevVnode) {\n            vm.$el = vm.patch(vm.$el, vnode);\n        } else {\n            vm.$el = vm.patch(prevVnode, vnode);\n        }\n        callHook(vm, \"updated\");\n    }\n    $destroy() {\n        callHook(vm, \"beforeDestroy\");\n        vm._isBeingDestroyed = true;\n        vm._isDestroyed = true;\n        callHook(vm, \"destroyed\");\n    }\n    render() {\n        const vm = this;\n        return vm.options.render.call(vm);\n    }\n    patch(oldVnode, vnode) {\n        const isRealElement = !!oldVnode.nodeType;\n\n        if (!isRealElement && sameVnode(oldVnode, vnode)) {\n            this.patchNode(oldVnode, vnode);\n        } else {\n            if (isRealElement) {\n                oldVnode = emptyNodeAt(oldVnode);\n            }\n            const element = oldVnode.element;\n            const parent = element.parentNode;\n\n            if (parent) {\n                createElement(vnode);\n                parent.insertBefore(vnode.element, element);\n                parent.removeChild(element);\n            }\n        }\n    }\n    patchNode(oldNode, newNode) {\n        const element = (newNode.element = oldNode.element);\n        const oldC = oldNode.children;\n        const C = newNode.children;\n\n        if (!newNode.text) {\n            if (oldC && C) {\n                this.updateChildren(oldC, C);\n            }\n        } else if (oldNode.text !== newNode.text) {\n            element.textContent = newNode.text;\n        }\n    }\n    updateChildren(oldC, C) {\n        if (sameVnode(oldC[0], C[0])) {\n            this.patchNode(oldC[0], C[0]);\n        } else {\n            this.patch(oldC[0], C[0]);\n        }\n    }\n    $watch(key, cb, options) {\n        new Watcher(this, key, cb);\n    }\n    $proxyData(key) {\n        const vm = this;\n        Object.defineProperty(vm, key, {\n            configurable: false,\n            enumerable: true,\n            get: function () {\n                return vm.data[key];\n            },\n            set: function (newVal) {\n                vm.data[key] = newVal;\n            },\n        });\n    }\n}\n\nfunction makeComputedGetter(getter, vm) {\n    const watcher = new Watcher(vm, getter, function () {}, { lazy: true });\n    return function computedGetter() {\n        // 缓存控制\n        if (watcher.dirty) {\n            watcher.evaluate();\n        }\n\n        if (Dep.target) {\n            watcher.depend();\n        }\n        return watcher.value;\n    };\n}\n\nfunction callHook(vm, hook) {\n    const handlers = vm.options[hook];\n    handlers && handlers.call(vm);\n}\n","import { EVue } from \"./js/evue\";\nimport { createVnode } from \"./js/vnode\";\n\nEVue.createVnode = createVnode;\n\nEVue.version = \"1.0.1\";\n\nexport default EVue;\n"],"names":["depid","Dep","constructor","options","id","key","subs","addSub","watcherInstance","push","removeSub","indexOf","splice","index","depend","target","addDep","notify","slice","forEach","sub","update","observer","data","Observer","walk","Object","entries","value","convert","val","defineReactive","dep","defineProperty","enumerable","configurable","get","set","newValue","Watcher","vm","expOrFn","cb","lazy","dirty","depIds","deps","getter","parseGetter","trim","undefined","oldValue","call","hasOwnProperty","i","length","evaluate","exp","test","exps","split","obj","len","Compile","el","$vm","$el","nodeType","document","querySelector","$fragment","nodeToFragment","compile","appendChild","fragment","createDocumentFragment","child","firstChild","childNodes","_this","Array","prototype","node","text","textContent","reg","compileElement","compileUtil","RegExp","$1","element","attrs","attributes","attr","attrName","name","attrValue","dir","substring","eventHandler","removeAttribute","bind","html","model","_getVMVal","addEventListener","e","_setVMVal","class","updaterFn","updater","eventType","fn","methods","k","textUpdater","htmlUpdater","innerHTML","classUpdater","className","replace","space","String","modelUpdater","Vnode","tag","children","createVnode","normalizeChildren","createTextNode","emptyNodeAt","elm","tagName","toLowerCase","createElement","vnode","setAttribute","createChildren","l","sameVnode","vnode1","vnode2","EVue","initState","$mount","getElementById","callHook","_isMounted","$compile","ops","initLifecycle","initData","initMethods","computed","initComputed","keys","$proxyData","userDef","defineComputed","def","makeComputedGetter","_isDestroyed","_isBeingDestroyed","render","prevVnode","_vnode","patch","$destroy","oldVnode","isRealElement","patchNode","parent","parentNode","insertBefore","removeChild","oldNode","newNode","oldC","C","updateChildren","$watch","newVal","watcher","computedGetter","hook","handlers","version"],"mappings":";;;;;;IAAA,IAAIA,KAAK,GAAG,CAAZ;IAEO,MAAMC,GAAN,CAAU;IACbC,EAAAA,WAAW,CAACC,OAAD,EAAU;IACjB,SAAKC,EAAL,GAAUJ,KAAK,EAAf;IACA,SAAKK,GAAL,GAAWF,OAAO,CAACE,GAAR,GAAcF,OAAO,CAACE,GAAtB,GAA4B,EAAvC;IACA,SAAKC,IAAL,GAAY,EAAZ;IACH;;IACDC,EAAAA,MAAM,CAACC,eAAD,EAAkB;IACpB,SAAKF,IAAL,CAAUG,IAAV,CAAeD,eAAf;IACH;;IACDE,EAAAA,SAAS,CAACF,eAAD,EAAkB;IACvB,QAAI,KAAKF,IAAL,CAAUK,OAAV,CAAkBH,eAAlB,MAAuC,CAAC,CAA5C,EAA+C;IAC3C,WAAKF,IAAL,CAAUM,MAAV,CAAiBC,KAAjB,EAAwB,CAAxB;IACH;IACJ;;IACDC,EAAAA,MAAM,GAAG;IACL;IACAb,IAAAA,GAAG,CAACc,MAAJ,IAAcd,GAAG,CAACc,MAAJ,CAAWC,MAAX,CAAkB,IAAlB,CAAd;IACH;;IACDC,EAAAA,MAAM,GAAG;IACL,UAAMX,IAAI,GAAG,KAAKA,IAAL,CAAUY,KAAV,EAAb;IACAZ,IAAAA,IAAI,CAACa,OAAL,CAAcC,GAAD,IAAS;IAClBA,MAAAA,GAAG,CAACC,MAAJ;IACH,KAFD;IAGH;;IAvBY;IA0BjBpB,GAAG,CAACc,MAAJ,GAAa,IAAb;;IC1BO,SAASO,QAAT,CAAkBC,IAAlB,EAAwB;IAC3B,MAAIA,IAAI,KAAK,IAAT,IAAiB,OAAOA,IAAP,KAAgB,QAArC,EAA+C;IAC3C,WAAO,IAAIC,QAAJ,CAAaD,IAAb,CAAP;IACH;;IACD;IACH;IAEM,MAAMC,QAAN,CAAe;IAClBtB,EAAAA,WAAW,CAACqB,IAAD,EAAO;IACd,SAAKA,IAAL,GAAYA,IAAZ;IACA,SAAKE,IAAL,CAAUF,IAAV;IACH;;IACDE,EAAAA,IAAI,CAACF,IAAD,EAAO;IACPG,IAAAA,MAAM,CAACC,OAAP,CAAeJ,IAAf,EAAqBJ,OAArB,CAA6B,CAAC,CAACd,GAAD,EAAMuB,KAAN,CAAD,EAAef,KAAf,KAAyB;IAClD,WAAKgB,OAAL,CAAaxB,GAAb,EAAkBuB,KAAlB;IACH,KAFD;IAGH;;IACDC,EAAAA,OAAO,CAACxB,GAAD,EAAMyB,GAAN,EAAW;IACd,SAAKC,cAAL,CAAoB,KAAKR,IAAzB,EAA+BlB,GAA/B,EAAoCyB,GAApC;IACH;;IACDC,EAAAA,cAAc,CAACR,IAAD,EAAOlB,GAAP,EAAYuB,KAAZ,EAAmB;IAC7B,UAAMI,GAAG,GAAG,IAAI/B,GAAJ,CAAQ;IAAEI,MAAAA;IAAF,KAAR,CAAZ;IACAiB,IAAAA,QAAQ,CAACM,KAAD,CAAR;IACAF,IAAAA,MAAM,CAACO,cAAP,CAAsBV,IAAtB,EAA4BlB,GAA5B,EAAiC;IAC7B6B,MAAAA,UAAU,EAAE,IADiB;IAE7BC,MAAAA,YAAY,EAAE,IAFe;IAG7BC,MAAAA,GAAG,EAAE,YAAY;IACb,YAAInC,GAAG,CAACc,MAAR,EAAgB;IACZiB,UAAAA,GAAG,CAAClB,MAAJ;IACH;;IACD,eAAOc,KAAP;IACH,OAR4B;IAS7BS,MAAAA,GAAG,EAAE,UAAUC,QAAV,EAAoB;IACrB,YAAIV,KAAK,KAAKU,QAAd,EAAwB;IACxBV,QAAAA,KAAK,GAAGU,QAAR;IACAhB,QAAAA,QAAQ,CAACgB,QAAD,CAAR;IACAN,QAAAA,GAAG,CAACf,MAAJ;IACH;IAd4B,KAAjC;IAgBH;;IAhCiB;;ICRf,MAAMsB,OAAN,CAAc;IACjBrC,EAAAA,WAAW,CAACsC,EAAD,EAAKC,OAAL,EAAcC,EAAd,EAAkBvC,OAAlB,EAA2B;IAClC,SAAKqC,EAAL,GAAUA,EAAV,CADkC;;IAGlC,SAAKG,IAAL,GAAYxC,OAAO,IAAIA,OAAO,CAACwC,IAA/B,CAHkC;;IAKlC,SAAKC,KAAL,GAAazC,OAAO,IAAIA,OAAO,CAACwC,IAAhC;IACA,SAAKF,OAAL,GAAeA,OAAf;IACA,SAAKC,EAAL,GAAUA,EAAV;IACA,SAAKG,MAAL,GAAc,EAAd;IACA,SAAKC,IAAL,GAAY,EAAZ;;IACA,QAAI,OAAOL,OAAP,KAAmB,UAAvB,EAAmC;IAC/B,WAAKM,MAAL,GAAcN,OAAd;IACH,KAFD,MAEO;IACH,WAAKM,MAAL,GAAc,KAAKC,WAAL,CAAiBP,OAAO,CAACQ,IAAR,EAAjB,CAAd;IACH;;IACD,SAAKrB,KAAL,GAAa,KAAKe,IAAL,GAAYO,SAAZ,GAAwB,KAAKd,GAAL,EAArC;IACH;;IACDf,EAAAA,MAAM,GAAG;IACL,QAAIO,KAAK,GAAG,KAAKQ,GAAL,EAAZ;IACA,QAAIe,QAAQ,GAAG,KAAKvB,KAApB,CAFK;;IAIL,QAAI,KAAKe,IAAT,EAAe,KAAKC,KAAL,GAAa,IAAb;;IACf,QAAIhB,KAAK,KAAKuB,QAAd,EAAwB;IACpB,WAAKvB,KAAL,GAAaA,KAAb;IACA,WAAKc,EAAL,CAAQU,IAAR,CAAa,KAAKZ,EAAlB,EAAsBZ,KAAtB,EAA6BuB,QAA7B;IACH;IACJ;;IACDnC,EAAAA,MAAM,CAACgB,GAAD,EAAM;IACR,QAAI,CAAC,KAAKa,MAAL,CAAYQ,cAAZ,CAA2BrB,GAAG,CAAC5B,EAA/B,CAAL,EAAyC;IACrC4B,MAAAA,GAAG,CAACzB,MAAJ,CAAW,IAAX;IACA,WAAKsC,MAAL,CAAYb,GAAG,CAAC5B,EAAhB,IAAsB4B,GAAtB;IACA,WAAKc,IAAL,CAAUrC,IAAV,CAAeuB,GAAf;IACH;IACJ;;IACDI,EAAAA,GAAG,GAAG;IACFnC,IAAAA,GAAG,CAACc,MAAJ,GAAa,IAAb;IACA,UAAMa,KAAK,GAAG,KAAKmB,MAAL,CAAYK,IAAZ,CAAiB,KAAKZ,EAAtB,EAA0B,KAAKA,EAA/B,CAAd;IACAvC,IAAAA,GAAG,CAACc,MAAJ,GAAa,IAAb;IACA,WAAOa,KAAP;IACH;;IACDd,EAAAA,MAAM,GAAG;IACL,QAAIwC,CAAC,GAAG,KAAKR,IAAL,CAAUS,MAAlB;;IACA,WAAOD,CAAC,EAAR,EAAY;IACR,WAAKR,IAAL,CAAUQ,CAAV,EAAaxC,MAAb;IACH;IACJ;;IACD0C,EAAAA,QAAQ,GAAG;IACP,SAAK5B,KAAL,GAAa,KAAKQ,GAAL,EAAb,CADO;;IAGP,SAAKQ,KAAL,GAAa,KAAb;IACH;;IACDI,EAAAA,WAAW,CAACS,GAAD,EAAM;IACb,QAAI,UAAUC,IAAV,CAAeD,GAAf,CAAJ,EAAyB;IACzB,QAAIE,IAAI,GAAGF,GAAG,CAACG,KAAJ,CAAU,GAAV,CAAX;IACA,WAAO,UAAUC,GAAV,EAAe;IAClB,WAAK,IAAIP,CAAC,GAAG,CAAR,EAAWQ,GAAG,GAAGH,IAAI,CAACJ,MAA3B,EAAmCD,CAAC,GAAGQ,GAAvC,EAA4CR,CAAC,EAA7C,EAAiD;IAC7C,YAAI,CAACO,GAAL,EAAU;IACVA,QAAAA,GAAG,GAAGA,GAAG,CAACF,IAAI,CAACL,CAAD,CAAL,CAAT;IACH;;IACD,aAAOO,GAAP;IACH,KAND;IAOH;;IA9DgB;;ICEd,MAAME,OAAN,CAAc;IACjB7D,EAAAA,WAAW,CAAC8D,EAAD,EAAKxB,EAAL,EAAS;IAChB,SAAKyB,GAAL,GAAWzB,EAAX;IACA,SAAK0B,GAAL,GAAWF,EAAE,CAACG,QAAH,KAAgB,CAAhB,GAAoBH,EAApB,GAAyBI,QAAQ,CAACC,aAAT,CAAuBL,EAAvB,CAApC;;IACA,QAAI,KAAKE,GAAT,EAAc;IACV,WAAKI,SAAL,GAAiB,KAAKC,cAAL,CAAoB,KAAKL,GAAzB,CAAjB;IACA,WAAKM,OAAL,CAAa,KAAKF,SAAlB;IACA,WAAKJ,GAAL,CAASO,WAAT,CAAqB,KAAKH,SAA1B;IACH;IACJ;;IACDC,EAAAA,cAAc,CAACP,EAAD,EAAK;IACf,QAAIU,QAAQ,GAAGN,QAAQ,CAACO,sBAAT,EAAf;IACA,QAAIC,KAAJ;;IACA,WAAQA,KAAK,GAAGZ,EAAE,CAACa,UAAnB,EAAgC;IAC5BH,MAAAA,QAAQ,CAACD,WAAT,CAAqBG,KAArB;IACH;;IACD,WAAOF,QAAP;IACH;;IACDF,EAAAA,OAAO,CAACE,QAAD,EAAW;IACd,QAAII,UAAU,GAAGJ,QAAQ,CAACI,UAA1B;;IACA,QAAIC,KAAK,GAAG,IAAZ;;IACAC,IAAAA,KAAK,CAACC,SAAN,CAAgB/D,KAAhB,CAAsBkC,IAAtB,CAA2B0B,UAA3B,EAAuC3D,OAAvC,CAAgD+D,IAAD,IAAU;IACrD,UAAIC,IAAI,GAAGD,IAAI,CAACE,WAAhB;IACA,UAAIC,GAAG,GAAG,cAAV,CAFqD;;IAIrD,UAAIH,IAAI,CAACf,QAAL,KAAkB,CAAtB,EAAyB;IACrBY,QAAAA,KAAK,CAACO,cAAN,CAAqBJ,IAArB;IACH;;IACD,UAAIA,IAAI,CAACf,QAAL,KAAkB,CAAlB,IAAuBkB,GAAG,CAAC3B,IAAJ,CAASyB,IAAT,CAA3B,EAA2C;IACvCI,QAAAA,WAAW,CAACJ,IAAZ,CAAiBD,IAAjB,EAAuB,KAAKjB,GAA5B,EAAiCuB,MAAM,CAACC,EAAxC;IACH;;IACD,UAAIP,IAAI,CAACJ,UAAL,IAAmBI,IAAI,CAACJ,UAAL,CAAgBvB,MAAvC,EAA+C;IAC3CwB,QAAAA,KAAK,CAACP,OAAN,CAAcU,IAAd;IACH;IACJ,KAbD;IAcH;;IACDI,EAAAA,cAAc,CAACI,OAAD,EAAU;IACpB,UAAMC,KAAK,GAAGD,OAAO,CAACE,UAAtB;;IACA,UAAMb,KAAK,GAAG,IAAd;;IACAC,IAAAA,KAAK,CAACC,SAAN,CAAgB/D,KAAhB,CAAsBkC,IAAtB,CAA2BuC,KAA3B,EAAkCxE,OAAlC,CAA2C0E,IAAD,IAAU;IAChD,UAAIC,QAAQ,GAAGD,IAAI,CAACE,IAApB;IACA,UAAIC,SAAS,GAAGH,IAAI,CAACjE,KAArB,CAFgD;;IAIhD,UAAIkE,QAAQ,CAACnF,OAAT,CAAiB,IAAjB,MAA2B,CAA/B,EAAkC;IAC9B,YAAIsF,GAAG,GAAGH,QAAQ,CAACI,SAAT,CAAmB,CAAnB,CAAV,CAD8B;;IAG9B,YAAID,GAAG,CAACtF,OAAJ,CAAY,IAAZ,MAAsB,CAA1B,EAA6B;IACzB4E,UAAAA,WAAW,CAACY,YAAZ,CAAyBT,OAAzB,EAAkCX,KAAK,CAACd,GAAxC,EAA6C+B,SAA7C,EAAwDC,GAAxD;IACH,SAFD,MAEO;IACHV,UAAAA,WAAW,CAACU,GAAD,CAAX,IAAoBV,WAAW,CAACU,GAAD,CAAX,CAAiBP,OAAjB,EAA0BX,KAAK,CAACd,GAAhC,EAAqC+B,SAArC,CAApB;IACH;;IACDN,QAAAA,OAAO,CAACU,eAAR,CAAwBN,QAAxB;IACH;IACJ,KAdD;IAeH;;IAtDgB;IAyDrB,MAAMP,WAAW,GAAG;IAChBJ,EAAAA,IAAI,EAAE,UAAUD,IAAV,EAAgB1C,EAAhB,EAAoBiB,GAApB,EAAyB;IAC3B,SAAK4C,IAAL,CAAUnB,IAAV,EAAgB1C,EAAhB,EAAoBiB,GAApB,EAAyB,MAAzB;IACH,GAHe;IAIhB6C,EAAAA,IAAI,EAAE,UAAUpB,IAAV,EAAgB1C,EAAhB,EAAoBiB,GAApB,EAAyB;IAC3B,SAAK4C,IAAL,CAAUnB,IAAV,EAAgB1C,EAAhB,EAAoBiB,GAApB,EAAyB,MAAzB;IACH,GANe;IAOhB8C,EAAAA,KAAK,EAAE,UAAUrB,IAAV,EAAgB1C,EAAhB,EAAoBiB,GAApB,EAAyB;IAC5B,SAAK4C,IAAL,CAAUnB,IAAV,EAAgB1C,EAAhB,EAAoBiB,GAApB,EAAyB,OAAzB;;IACA,QAAIsB,KAAK,GAAG,IAAZ;;IACA,QAAIjD,GAAG,GAAGiD,KAAK,CAACyB,SAAN,CAAgBhE,EAAhB,EAAoBiB,GAApB,CAAV;;IACAyB,IAAAA,IAAI,CAACuB,gBAAL,CAAsB,OAAtB,EAA+B,UAAUC,CAAV,EAAa;IACxC,UAAIpE,QAAQ,GAAGoE,CAAC,CAAC3F,MAAF,CAASa,KAAxB;;IACA,UAAIE,GAAG,KAAKQ,QAAZ,EAAsB;IAClB;IACH;;IAEDyC,MAAAA,KAAK,CAAC4B,SAAN,CAAgBnE,EAAhB,EAAoBiB,GAApB,EAAyBnB,QAAzB;;IACAR,MAAAA,GAAG,GAAGQ,QAAN;IACH,KARD;IASH,GApBe;IAqBhBsE,EAAAA,KAAK,EAAE,UAAU1B,IAAV,EAAgB1C,EAAhB,EAAoBiB,GAApB,EAAyB;IAC5B,SAAK4C,IAAL,CAAUnB,IAAV,EAAgB1C,EAAhB,EAAoBiB,GAApB,EAAyB,OAAzB;IACH,GAvBe;IAwBhB4C,EAAAA,IAAI,EAAE,UAAUnB,IAAV,EAAgB1C,EAAhB,EAAoBiB,GAApB,EAAyBwC,GAAzB,EAA8B;IAChC,QAAIY,SAAS,GAAGC,OAAO,CAACb,GAAG,GAAG,SAAP,CAAvB;IAEAY,IAAAA,SAAS,IAAIA,SAAS,CAAC3B,IAAD,EAAO,KAAKsB,SAAL,CAAehE,EAAf,EAAmBiB,GAAnB,EAAwBwC,GAAxB,CAAP,CAAtB;IAEA,QAAI1D,OAAJ,CAAYC,EAAZ,EAAgBiB,GAAhB,EAAqB,UAAU7B,KAAV,EAAiBuB,QAAjB,EAA2B;IAC5C0D,MAAAA,SAAS,IAAIA,SAAS,CAAC3B,IAAD,EAAOtD,KAAP,EAAcuB,QAAd,CAAtB;IACH,KAFD;IAGH,GAhCe;IAiChBgD,EAAAA,YAAY,EAAE,UAAUjB,IAAV,EAAgB1C,EAAhB,EAAoBiB,GAApB,EAAyBwC,GAAzB,EAA8B;IACxC,QAAIc,SAAS,GAAGd,GAAG,CAACrC,KAAJ,CAAU,GAAV,EAAe,CAAf,CAAhB;IACA,QAAIoD,EAAE,GAAGxE,EAAE,CAACrC,OAAH,CAAW8G,OAAX,IAAsBzE,EAAE,CAACrC,OAAH,CAAW8G,OAAX,CAAmBxD,GAAnB,CAA/B;;IAEA,QAAIsD,SAAS,IAAIC,EAAjB,EAAqB;IACjB9B,MAAAA,IAAI,CAACuB,gBAAL,CAAsBM,SAAtB,EAAiCC,EAAE,CAACX,IAAH,CAAQ7D,EAAR,CAAjC,EAA8C,KAA9C;IACH;IACJ,GAxCe;IAyChBgE,EAAAA,SAAS,EAAE,UAAUhE,EAAV,EAAciB,GAAd,EAAmBwC,GAAnB,EAAwB;IAC/B,QAAInE,GAAG,GAAGU,EAAV;IACAiB,IAAAA,GAAG,CAACG,KAAJ,CAAU,GAAV,EAAezC,OAAf,CAAuB,UAAU+F,CAAV,EAAa;IAChCpF,MAAAA,GAAG,GAAGA,GAAG,CAACoF,CAAC,CAACjE,IAAF,EAAD,CAAT;IACH,KAFD;IAGA,WAAOnB,GAAP;IACH,GA/Ce;IAiDhB6E,EAAAA,SAAS,EAAE,UAAUnE,EAAV,EAAciB,GAAd,EAAmB7B,KAAnB,EAA0B;IACjC,QAAIE,GAAG,GAAGU,EAAV;IACAiB,IAAAA,GAAG,GAAGA,GAAG,CAACG,KAAJ,CAAU,GAAV,CAAN;IACAH,IAAAA,GAAG,CAACtC,OAAJ,CAAY,UAAU+F,CAAV,EAAa5D,CAAb,EAAgB;IACxB;IACA,UAAIA,CAAC,GAAGG,GAAG,CAACF,MAAJ,GAAa,CAArB,EAAwB;IACpBzB,QAAAA,GAAG,GAAGA,GAAG,CAACoF,CAAD,CAAT;IACH,OAFD,MAEO;IACHpF,QAAAA,GAAG,CAACoF,CAAD,CAAH,GAAStF,KAAT;IACH;IACJ,KAPD;IAQH;IA5De,CAApB;IA+DA,MAAMkF,OAAO,GAAG;IACZK,EAAAA,WAAW,EAAE,UAAUjC,IAAV,EAAgBtD,KAAhB,EAAuB;IAChCsD,IAAAA,IAAI,CAACE,WAAL,GAAmB,OAAOxD,KAAP,IAAgB,WAAhB,GAA8B,EAA9B,GAAmCA,KAAtD;IACH,GAHW;IAIZwF,EAAAA,WAAW,EAAE,UAAUlC,IAAV,EAAgBtD,KAAhB,EAAuB;IAChCsD,IAAAA,IAAI,CAACmC,SAAL,GAAiB,OAAOzF,KAAP,IAAgB,WAAhB,GAA8B,EAA9B,GAAmCA,KAApD;IACH,GANW;IAOZ0F,EAAAA,YAAY,EAAE,UAAUpC,IAAV,EAAgBtD,KAAhB,EAAuBuB,QAAvB,EAAiC;IAC3C,QAAIoE,SAAS,GAAGrC,IAAI,CAACqC,SAArB;IACAA,IAAAA,SAAS,GAAGA,SAAS,CAACC,OAAV,CAAkBrE,QAAlB,EAA4B,EAA5B,EAAgCqE,OAAhC,CAAwC,KAAxC,EAA+C,EAA/C,CAAZ;IACA,QAAIC,KAAK,GAAGF,SAAS,IAAIG,MAAM,CAAC9F,KAAD,CAAnB,GAA6B,GAA7B,GAAmC,EAA/C;IACAsD,IAAAA,IAAI,CAACqC,SAAL,GAAiBA,SAAS,GAAGE,KAAZ,GAAoB7F,KAArC;IACH,GAZW;IAaZ+F,EAAAA,YAAY,EAAE,UAAUzC,IAAV,EAAgBtD,KAAhB,EAAuBuB,QAAvB,EAAiC;IAC3C+B,IAAAA,IAAI,CAACtD,KAAL,GAAa,OAAOA,KAAP,IAAgB,WAAhB,GAA8B,EAA9B,GAAmCA,KAAhD;IACH;IAfW,CAAhB;;IC3HA,SAASgG,KAAT,CAAeC,GAAf,EAAoBtG,IAApB,EAA0BuG,QAA1B,EAAoC3C,IAApC,EAA0CO,OAA1C,EAAmD;IAC/C,OAAKmC,GAAL,GAAWA,GAAX,CAD+C;;IAE/C,OAAKtG,IAAL,GAAYA,IAAZ,CAF+C;;IAG/C,OAAKuG,QAAL,GAAgBA,QAAhB,CAH+C;;IAI/C,OAAK3C,IAAL,GAAYA,IAAZ,CAJ+C;;IAK/C,OAAKO,OAAL,GAAeA,OAAf,CAL+C;IAMlD;;IAEM,SAASqC,WAAT,CAAqBF,GAArB,EAA0BtG,IAA1B,EAAgCuG,QAAhC,EAA0C;IAC7C,SAAO,IAAIF,KAAJ,CAAUC,GAAV,EAAetG,IAAf,EAAqByG,iBAAiB,CAACF,QAAD,CAAtC,EAAkD5E,SAAlD,EAA6DA,SAA7D,CAAP;IACH;IAEM,SAAS+E,cAAT,CAAwBnG,GAAxB,EAA6B;IAChC,SAAO,IAAI8F,KAAJ,CAAU1E,SAAV,EAAqBA,SAArB,EAAgCA,SAAhC,EAA2CwE,MAAM,CAAC5F,GAAD,CAAjD,CAAP;IACH;IAEM,SAASoG,WAAT,CAAqBC,GAArB,EAA0B;IAC7B,SAAO,IAAIP,KAAJ,CAAUO,GAAG,CAACC,OAAJ,CAAYC,WAAZ,EAAV,EAAqC,EAArC,EAAyC,EAAzC,EAA6CnF,SAA7C,EAAwDiF,GAAxD,CAAP;IACH;;IAGM,SAASG,aAAT,CAAuBC,KAAvB,EAA8B;IACjC,MAAI,CAACA,KAAL,EAAY;IACZ,QAAM;IAAEV,IAAAA,GAAF;IAAOtG,IAAAA,IAAP;IAAauG,IAAAA;IAAb,MAA0BS,KAAhC,CAFiC;;IAIjC,MAAIV,GAAJ,EAAS;IACLU,IAAAA,KAAK,CAAC7C,OAAN,GAAgBtB,QAAQ,CAACkE,aAAT,CAAuBT,GAAvB,CAAhB;;IACA,QAAItG,IAAI,CAACoE,KAAT,EAAgB;IACZ,WAAK,IAAItF,GAAT,IAAgBkB,IAAI,CAACoE,KAArB,EAA4B;IACxB4C,QAAAA,KAAK,CAAC7C,OAAN,CAAc8C,YAAd,CAA2BnI,GAA3B,EAAgCkB,IAAI,CAACoE,KAAL,CAAWtF,GAAX,CAAhC;IACH;IACJ;;IACD,QAAIyH,QAAJ,EAAc;IACVW,MAAAA,cAAc,CAACF,KAAD,EAAQT,QAAR,CAAd;IACH;IACJ,GAVD,MAUO;IACHS,IAAAA,KAAK,CAAC7C,OAAN,GAAgBtB,QAAQ,CAAC6D,cAAT,CAAwBM,KAAK,CAACpD,IAA9B,CAAhB;IACH;;IACD,SAAOoD,KAAK,CAAC7C,OAAb;IACH;;IAED,SAASsC,iBAAT,CAA2BF,QAA3B,EAAqC;IACjC,MAAI,OAAOA,QAAP,KAAoB,QAAxB,EAAkC;IAC9B,WAAO,CAACG,cAAc,CAACH,QAAD,CAAf,CAAP;IACH;;IACD,SAAOA,QAAP;IACH;;IAED,SAASW,cAAT,CAAwBF,KAAxB,EAA+BT,QAA/B,EAAyC;IACrC,QAAMY,CAAC,GAAGZ,QAAQ,CAACvE,MAAnB;;IACA,OAAK,IAAI1C,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG6H,CAA5B,EAA+B7H,KAAK,EAApC,EAAwC;IACpC0H,IAAAA,KAAK,CAAC7C,OAAN,CAAcjB,WAAd,CAA0B6D,aAAa,CAACR,QAAQ,CAACjH,KAAD,CAAT,CAAvC;IACH;IACJ;;IAEM,SAAS8H,SAAT,CAAmBC,MAAnB,EAA2BC,MAA3B,EAAmC;IACtC,SAAOD,MAAM,CAACf,GAAP,KAAegB,MAAM,CAAChB,GAA7B;IACH;;ICnDM,MAAMiB,IAAN,CAAW;IACd5I,EAAAA,WAAW,CAACC,OAAD,EAAU;IACjB,SAAKA,OAAL,GAAeA,OAAO,IAAI,EAA1B;IACA,SAAKoB,IAAL,GAAYpB,OAAO,CAACoB,IAApB;IACA,SAAKyC,EAAL,GAAU7D,OAAO,CAAC6D,EAAR,IAAc,MAAxB;IACA,SAAK+E,SAAL,GAJiB;;IAKjB,SAAKC,MAAL,CAAY5E,QAAQ,CAAC6E,cAAT,CAAwB,QAAxB,CAAZ;IACAC,IAAAA,QAAQ,CAAC,IAAD,EAAO,aAAP,CAAR;IACA,SAAKC,UAAL,GAAkB,IAAlB;IACA,SAAKC,QAAL,GAAgB,IAAIrF,OAAJ,CAAY,KAAKC,EAAjB,EAAqB,IAArB,CAAhB;IACAkF,IAAAA,QAAQ,CAAC,IAAD,EAAO,SAAP,CAAR;IACH;;IACDH,EAAAA,SAAS,GAAG;IACR,UAAMvG,EAAE,GAAG,IAAX;IACA,UAAM6G,GAAG,GAAG7G,EAAE,CAACrC,OAAf;IACA,SAAKmJ,aAAL,CAAmB9G,EAAnB;IACA0G,IAAAA,QAAQ,CAAC1G,EAAD,EAAK,cAAL,CAAR;IACA6G,IAAAA,GAAG,CAAC9H,IAAJ,IAAYiB,EAAE,CAAC+G,QAAH,EAAZ;IACAF,IAAAA,GAAG,CAACpC,OAAJ,IAAezE,EAAE,CAACgH,WAAH,EAAf;IACAH,IAAAA,GAAG,CAACI,QAAJ,IAAgBjH,EAAE,CAACkH,YAAH,EAAhB;IACAR,IAAAA,QAAQ,CAAC1G,EAAD,EAAK,SAAL,CAAR;IACH;;IACD+G,EAAAA,QAAQ,GAAG;IACP,UAAM/G,EAAE,GAAG,IAAX;IACA,UAAMjB,IAAI,GAAGiB,EAAE,CAACrC,OAAH,CAAWoB,IAAxB,CAFO;;IAIPG,IAAAA,MAAM,CAACiI,IAAP,CAAYpI,IAAZ,EAAkBJ,OAAlB,CAA0B,UAAUd,GAAV,EAAe;IACrCmC,MAAAA,EAAE,CAACoH,UAAH,CAAcvJ,GAAd;IACH,KAFD;IAGAiB,IAAAA,QAAQ,CAAC,KAAKC,IAAN,CAAR;IACH;;IACDiI,EAAAA,WAAW,GAAG;IACV,UAAMhH,EAAE,GAAG,IAAX;IACA,UAAMyE,OAAO,GAAGzE,EAAE,CAACrC,OAAH,CAAW8G,OAA3B;;IACA,SAAK,IAAI5G,GAAT,IAAgB4G,OAAhB,EAAyB;IACrBzE,MAAAA,EAAE,CAACnC,GAAD,CAAF,GAAU4G,OAAO,CAAC5G,GAAD,CAAP,CAAagG,IAAb,CAAkB7D,EAAlB,CAAV;IACH;IACJ;;IACDkH,EAAAA,YAAY,GAAG;IACX,UAAMlH,EAAE,GAAG,IAAX;IACA,UAAMiH,QAAQ,GAAGjH,EAAE,CAACrC,OAAH,CAAWsJ,QAA5B;;IACA,SAAK,IAAIpJ,GAAT,IAAgBoJ,QAAhB,EAA0B;IACtB,YAAMI,OAAO,GAAGJ,QAAQ,CAACpJ,GAAD,CAAxB,CADsB;;IAEtBmC,MAAAA,EAAE,CAACsH,cAAH,CAAkBtH,EAAlB,EAAsBnC,GAAtB,EAA2BwJ,OAA3B;IACH;IACJ;;IACDC,EAAAA,cAAc,CAACtH,EAAD,EAAKnC,GAAL,EAAUwJ,OAAV,EAAmB;IAC7B,UAAME,GAAG,GAAG;IAAE7H,MAAAA,UAAU,EAAE,IAAd;IAAoBC,MAAAA,YAAY,EAAE;IAAlC,KAAZ;IACA4H,IAAAA,GAAG,CAAC3H,GAAJ,GAAU4H,kBAAkB,CAACH,OAAD,EAAUrH,EAAV,CAA5B;IACAuH,IAAAA,GAAG,CAAC1H,GAAJ,GAAUwH,OAAO,CAACxH,GAAR,GAAcwH,OAAO,CAACxH,GAAtB,GAA4B,YAAY,EAAlD;IACAX,IAAAA,MAAM,CAACO,cAAP,CAAsBO,EAAtB,EAA0BnC,GAA1B,EAA+B0J,GAA/B;IACH;;IACDT,EAAAA,aAAa,CAAC9G,EAAD,EAAK;IACdA,IAAAA,EAAE,CAAC2G,UAAH,GAAgB,KAAhB;IACA3G,IAAAA,EAAE,CAACyH,YAAH,GAAkB,KAAlB;IACAzH,IAAAA,EAAE,CAAC0H,iBAAH,GAAuB,KAAvB;IACH;;IACDlB,EAAAA,MAAM,CAACtD,OAAD,EAAU;IACZ,UAAMlD,EAAE,GAAG,IAAX;IACA,UAAM+F,KAAK,GAAG/F,EAAE,CAAC2H,MAAH,EAAd;IACA3H,IAAAA,EAAE,CAAC0B,GAAH,GAASwB,OAAT;IACAlD,IAAAA,EAAE,CAACnB,MAAH,CAAUkH,KAAV;IACH;;IACDlH,EAAAA,MAAM,CAACkH,KAAD,EAAQ;IACV,UAAM/F,EAAE,GAAG,IAAX;IACA,UAAM4H,SAAS,GAAG5H,EAAE,CAAC6H,MAArB;IACA7H,IAAAA,EAAE,CAAC6H,MAAH,GAAY9B,KAAZ;IACA/F,IAAAA,EAAE,CAAC2G,UAAH,IAAiBD,QAAQ,CAAC1G,EAAD,EAAK,cAAL,CAAzB;;IAEA,QAAI,CAAC4H,SAAL,EAAgB;IACZ5H,MAAAA,EAAE,CAAC0B,GAAH,GAAS1B,EAAE,CAAC8H,KAAH,CAAS9H,EAAE,CAAC0B,GAAZ,EAAiBqE,KAAjB,CAAT;IACH,KAFD,MAEO;IACH/F,MAAAA,EAAE,CAAC0B,GAAH,GAAS1B,EAAE,CAAC8H,KAAH,CAASF,SAAT,EAAoB7B,KAApB,CAAT;IACH;;IACDW,IAAAA,QAAQ,CAAC1G,EAAD,EAAK,SAAL,CAAR;IACH;;IACD+H,EAAAA,QAAQ,GAAG;IACPrB,IAAAA,QAAQ,CAAC1G,EAAD,EAAK,eAAL,CAAR;IACAA,IAAAA,EAAE,CAAC0H,iBAAH,GAAuB,IAAvB;IACA1H,IAAAA,EAAE,CAACyH,YAAH,GAAkB,IAAlB;IACAf,IAAAA,QAAQ,CAAC1G,EAAD,EAAK,WAAL,CAAR;IACH;;IACD2H,EAAAA,MAAM,GAAG;IACL,UAAM3H,EAAE,GAAG,IAAX;IACA,WAAOA,EAAE,CAACrC,OAAH,CAAWgK,MAAX,CAAkB/G,IAAlB,CAAuBZ,EAAvB,CAAP;IACH;;IACD8H,EAAAA,KAAK,CAACE,QAAD,EAAWjC,KAAX,EAAkB;IACnB,UAAMkC,aAAa,GAAG,CAAC,CAACD,QAAQ,CAACrG,QAAjC;;IAEA,QAAI,CAACsG,aAAD,IAAkB9B,SAAS,CAAC6B,QAAD,EAAWjC,KAAX,CAA/B,EAAkD;IAC9C,WAAKmC,SAAL,CAAeF,QAAf,EAAyBjC,KAAzB;IACH,KAFD,MAEO;IACH,UAAIkC,aAAJ,EAAmB;IACfD,QAAAA,QAAQ,GAAGtC,WAAW,CAACsC,QAAD,CAAtB;IACH;;IACD,YAAM9E,OAAO,GAAG8E,QAAQ,CAAC9E,OAAzB;IACA,YAAMiF,MAAM,GAAGjF,OAAO,CAACkF,UAAvB;;IAEA,UAAID,MAAJ,EAAY;IACRrC,QAAAA,aAAa,CAACC,KAAD,CAAb;IACAoC,QAAAA,MAAM,CAACE,YAAP,CAAoBtC,KAAK,CAAC7C,OAA1B,EAAmCA,OAAnC;IACAiF,QAAAA,MAAM,CAACG,WAAP,CAAmBpF,OAAnB;IACH;IACJ;IACJ;;IACDgF,EAAAA,SAAS,CAACK,OAAD,EAAUC,OAAV,EAAmB;IACxB,UAAMtF,OAAO,GAAIsF,OAAO,CAACtF,OAAR,GAAkBqF,OAAO,CAACrF,OAA3C;IACA,UAAMuF,IAAI,GAAGF,OAAO,CAACjD,QAArB;IACA,UAAMoD,CAAC,GAAGF,OAAO,CAAClD,QAAlB;;IAEA,QAAI,CAACkD,OAAO,CAAC7F,IAAb,EAAmB;IACf,UAAI8F,IAAI,IAAIC,CAAZ,EAAe;IACX,aAAKC,cAAL,CAAoBF,IAApB,EAA0BC,CAA1B;IACH;IACJ,KAJD,MAIO,IAAIH,OAAO,CAAC5F,IAAR,KAAiB6F,OAAO,CAAC7F,IAA7B,EAAmC;IACtCO,MAAAA,OAAO,CAACN,WAAR,GAAsB4F,OAAO,CAAC7F,IAA9B;IACH;IACJ;;IACDgG,EAAAA,cAAc,CAACF,IAAD,EAAOC,CAAP,EAAU;IACpB,QAAIvC,SAAS,CAACsC,IAAI,CAAC,CAAD,CAAL,EAAUC,CAAC,CAAC,CAAD,CAAX,CAAb,EAA8B;IAC1B,WAAKR,SAAL,CAAeO,IAAI,CAAC,CAAD,CAAnB,EAAwBC,CAAC,CAAC,CAAD,CAAzB;IACH,KAFD,MAEO;IACH,WAAKZ,KAAL,CAAWW,IAAI,CAAC,CAAD,CAAf,EAAoBC,CAAC,CAAC,CAAD,CAArB;IACH;IACJ;;IACDE,EAAAA,MAAM,CAAC/K,GAAD,EAAMqC,EAAN,EAAUvC,OAAV,EAAmB;IACrB,QAAIoC,OAAJ,CAAY,IAAZ,EAAkBlC,GAAlB,EAAuBqC,EAAvB;IACH;;IACDkH,EAAAA,UAAU,CAACvJ,GAAD,EAAM;IACZ,UAAMmC,EAAE,GAAG,IAAX;IACAd,IAAAA,MAAM,CAACO,cAAP,CAAsBO,EAAtB,EAA0BnC,GAA1B,EAA+B;IAC3B8B,MAAAA,YAAY,EAAE,KADa;IAE3BD,MAAAA,UAAU,EAAE,IAFe;IAG3BE,MAAAA,GAAG,EAAE,YAAY;IACb,eAAOI,EAAE,CAACjB,IAAH,CAAQlB,GAAR,CAAP;IACH,OAL0B;IAM3BgC,MAAAA,GAAG,EAAE,UAAUgJ,MAAV,EAAkB;IACnB7I,QAAAA,EAAE,CAACjB,IAAH,CAAQlB,GAAR,IAAegL,MAAf;IACH;IAR0B,KAA/B;IAUH;;IA5Ia;;IA+IlB,SAASrB,kBAAT,CAA4BjH,MAA5B,EAAoCP,EAApC,EAAwC;IACpC,QAAM8I,OAAO,GAAG,IAAI/I,OAAJ,CAAYC,EAAZ,EAAgBO,MAAhB,EAAwB,YAAY,EAApC,EAAwC;IAAEJ,IAAAA,IAAI,EAAE;IAAR,GAAxC,CAAhB;IACA,SAAO,SAAS4I,cAAT,GAA0B;IAC7B;IACA,QAAID,OAAO,CAAC1I,KAAZ,EAAmB;IACf0I,MAAAA,OAAO,CAAC9H,QAAR;IACH;;IAED,QAAIvD,GAAG,CAACc,MAAR,EAAgB;IACZuK,MAAAA,OAAO,CAACxK,MAAR;IACH;;IACD,WAAOwK,OAAO,CAAC1J,KAAf;IACH,GAVD;IAWH;;IAED,SAASsH,QAAT,CAAkB1G,EAAlB,EAAsBgJ,IAAtB,EAA4B;IACxB,QAAMC,QAAQ,GAAGjJ,EAAE,CAACrC,OAAH,CAAWqL,IAAX,CAAjB;IACAC,EAAAA,QAAQ,IAAIA,QAAQ,CAACrI,IAAT,CAAcZ,EAAd,CAAZ;IACH;;ICpKDsG,IAAI,CAACf,WAAL,GAAmBA,WAAnB;IAEAe,IAAI,CAAC4C,OAAL,GAAe,OAAf;;;;;;;;"}