{"version":3,"file":"eVue.common.js","sources":["../eVue-03/src/dep.js","../eVue-03/src/observer.js","../eVue-03/src/watcher.js","../eVue-03/src/compile.js","../eVue-03/src/shared/utils.js","../eVue-03/src/vdom/vnode.js","../eVue-03/src/vdom/patch.js","../eVue-03/src/evue.js","../eVue-03/index.js"],"sourcesContent":["let depid = 0;\n\nexport class Dep {\n\tconstructor(options) {\n\t\tthis.id = depid++;\n\t\tthis.key = options.key ? options.key : '';\n\t\tthis.subs = [];\n\t}\n\taddSub(watcherInstance) {\n\t\tthis.subs.push(watcherInstance);\n\t}\n\tremoveSub(watcherInstance) {\n\t\tif (this.subs.indexOf(watcherInstance) !== -1) {\n\t\t\tthis.subs.splice(index, 1);\n\t\t}\n\t}\n\tdepend() {\n\t\t// Dep.target 指向的是 watcherInstance\n\t\tDep.target && Dep.target.addDep(this);\n\t}\n\tnotify() {\n\t\tconst subs = this.subs.slice();\n\t\tsubs.forEach((sub) => {\n\t\t\tsub.update();\n\t\t});\n\t}\n}\n\nDep.target = null;\n","import { Dep } from './dep';\n\nexport function observer(data) {\n\tif (data !== null && typeof data === 'object') {\n\t\treturn new Observer(data);\n\t}\n\treturn;\n}\n\nexport class Observer {\n\tconstructor(data) {\n\t\tthis.data = data;\n\t\tthis.walk(data);\n\t}\n\twalk(data) {\n\t\tObject.entries(data).forEach(([key, value], index) => {\n\t\t\tthis.convert(key, value);\n\t\t});\n\t}\n\tconvert(key, val) {\n\t\tthis.defineReactive(this.data, key, val);\n\t}\n\tdefineReactive(data, key, value) {\n\t\tconst dep = new Dep({ key });\n\t\tobserver(value);\n\t\tObject.defineProperty(data, key, {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: true,\n\t\t\tget: function () {\n\t\t\t\tif (Dep.target) {\n\t\t\t\t\tdep.depend();\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tset: function (newValue) {\n\t\t\t\tif (value === newValue) return;\n\t\t\t\tvalue = newValue;\n\t\t\t\tobserver(newValue);\n\t\t\t\tdep.notify();\n\t\t\t},\n\t\t});\n\t}\n}\n","import { Dep } from './dep';\nexport class Watcher {\n\tconstructor(vm, expOrFn, cb, options) {\n\t\tthis.vm = vm;\n\t\t// lazy 表示一种固定描述，不可改变，表示这个 watcher 需要缓存\n\t\tthis.lazy = options && options.lazy;\n\t\t// dirty 表示缓存是否可用，如果为 true，表示缓存脏了，需要重新计算，否则不用\n\t\tthis.dirty = options && options.lazy;\n\t\tthis.expOrFn = expOrFn;\n\t\tthis.cb = cb;\n\t\tthis.depIds = {};\n\t\tthis.deps = [];\n\t\tif (typeof expOrFn === 'function') {\n\t\t\tthis.getter = expOrFn;\n\t\t} else {\n\t\t\tthis.getter = this.parseGetter(expOrFn.trim());\n\t\t}\n\t\tthis.value = this.lazy ? undefined : this.get();\n\t}\n\tupdate() {\n\t\tlet value = this.get();\n\t\tlet oldValue = this.value;\n\t\t// 当通知 computed 更新的时候，就只是 把 dirty 设置为 true，从而 读取 comptued 时，便会调用 evalute 重新计算\n\t\tif (this.lazy) this.dirty = true;\n\t\tif (value !== oldValue) {\n\t\t\tthis.value = value;\n\t\t\tthis.cb.call(this.vm, value, oldValue);\n\t\t}\n\t}\n\taddDep(dep) {\n\t\tif (!this.depIds.hasOwnProperty(dep.id)) {\n\t\t\tdep.addSub(this);\n\t\t\tthis.depIds[dep.id] = dep;\n\t\t\tthis.deps.push(dep);\n\t\t}\n\t}\n\tget() {\n\t\tDep.target = this;\n\t\tconst value = this.getter.call(this.vm, this.vm);\n\t\tDep.target = null;\n\t\treturn value;\n\t}\n\tdepend() {\n\t\tlet i = this.deps.length;\n\t\twhile (i--) {\n\t\t\tthis.deps[i].depend();\n\t\t}\n\t}\n\tevaluate() {\n\t\tthis.value = this.get();\n\t\t// 执行完更新函数之后，立即重置标志位\n\t\tthis.dirty = false;\n\t}\n\tparseGetter(exp) {\n\t\tif (/[^\\w.$]/.test(exp)) return;\n\t\tvar exps = exp.split('.');\n\t\treturn function (obj) {\n\t\t\tfor (var i = 0, len = exps.length; i < len; i++) {\n\t\t\t\tif (!obj) return;\n\t\t\t\tobj = obj[exps[i]];\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\t}\n}\n","import { Watcher } from './watcher';\n\nexport class Compile {\n\tconstructor(el, vm) {\n\t\tthis.$vm = vm;\n\t\tthis.$el = el.nodeType === 1 ? el : document.querySelector(el);\n\t\tif (this.$el) {\n\t\t\tthis.$fragment = this.nodeToFragment(this.$el);\n\t\t\tthis.compile(this.$fragment);\n\t\t\tthis.$el.appendChild(this.$fragment);\n\t\t}\n\t}\n\tnodeToFragment(el) {\n\t\tlet fragment = document.createDocumentFragment();\n\t\tlet child;\n\t\twhile ((child = el.firstChild)) {\n\t\t\tfragment.appendChild(child);\n\t\t}\n\t\treturn fragment;\n\t}\n\tcompile(fragment) {\n\t\tlet childNodes = fragment.childNodes;\n\t\tlet _this = this;\n\t\tArray.prototype.slice.call(childNodes).forEach((node) => {\n\t\t\tlet text = node.textContent;\n\t\t\tlet reg = /\\{\\{(.*)\\}\\}/; // 表达式文本\n\n\t\t\tif (node.nodeType === 1) {\n\t\t\t\t_this.compileElement(node);\n\t\t\t}\n\t\t\tif (node.nodeType === 3 && reg.test(text)) {\n\t\t\t\tcompileUtil.text(node, this.$vm, RegExp.$1);\n\t\t\t}\n\t\t\tif (node.childNodes && node.childNodes.length) {\n\t\t\t\t_this.compile(node);\n\t\t\t}\n\t\t});\n\t}\n\tcompileElement(element) {\n\t\tconst attrs = element.attributes;\n\t\tconst _this = this;\n\t\tArray.prototype.slice.call(attrs).forEach((attr) => {\n\t\t\tlet attrName = attr.name;\n\t\t\tlet attrValue = attr.value;\n\t\t\t// 如 <span v-text=\"content\"></span> 中指令为 v-text\n\t\t\tif (attrName.indexOf('v-') === 0) {\n\t\t\t\tlet dir = attrName.substring(2);\n\t\t\t\t// 绑定methods\n\t\t\t\tif (dir.indexOf('on') === 0) {\n\t\t\t\t\tcompileUtil.eventHandler(element, _this.$vm, attrValue, dir);\n\t\t\t\t} else {\n\t\t\t\t\tcompileUtil[dir] && compileUtil[dir](element, _this.$vm, attrValue);\n\t\t\t\t}\n\t\t\t\telement.removeAttribute(attrName);\n\t\t\t}\n\t\t});\n\t}\n}\n\nconst compileUtil = {\n\ttext: function (node, vm, exp) {\n\t\tthis.bind(node, vm, exp, 'text');\n\t},\n\thtml: function (node, vm, exp) {\n\t\tthis.bind(node, vm, exp, 'html');\n\t},\n\tmodel: function (node, vm, exp) {\n\t\tthis.bind(node, vm, exp, 'model');\n\t\tlet _this = this;\n\t\tlet val = _this._getVMVal(vm, exp);\n\t\tnode.addEventListener('input', function (e) {\n\t\t\tlet newValue = e.target.value;\n\t\t\tif (val === newValue) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_this._setVMVal(vm, exp, newValue);\n\t\t\tval = newValue;\n\t\t});\n\t},\n\tclass: function (node, vm, exp) {\n\t\tthis.bind(node, vm, exp, 'class');\n\t},\n\tbind: function (node, vm, exp, dir) {\n\t\tlet updaterFn = updater[dir + 'Updater'];\n\n\t\tupdaterFn && updaterFn(node, this._getVMVal(vm, exp, dir));\n\n\t\tnew Watcher(vm, exp, function (value, oldValue) {\n\t\t\tupdaterFn && updaterFn(node, value, oldValue);\n\t\t});\n\t},\n\teventHandler: function (node, vm, exp, dir) {\n\t\tlet eventType = dir.split(':')[1];\n\t\tlet fn = vm.options.methods && vm.options.methods[exp];\n\n\t\tif (eventType && fn) {\n\t\t\tnode.addEventListener(eventType, fn.bind(vm), false);\n\t\t}\n\t},\n\t_getVMVal: function (vm, exp, dir) {\n\t\tlet val = vm;\n\t\texp.split('.').forEach(function (k) {\n\t\t\tval = val[k.trim()];\n\t\t});\n\t\treturn val;\n\t},\n\n\t_setVMVal: function (vm, exp, value) {\n\t\tlet val = vm;\n\t\texp = exp.split('.');\n\t\texp.forEach(function (k, i) {\n\t\t\t// 非最后一个key，更新val的值\n\t\t\tif (i < exp.length - 1) {\n\t\t\t\tval = val[k];\n\t\t\t} else {\n\t\t\t\tval[k] = value;\n\t\t\t}\n\t\t});\n\t},\n};\n\nconst updater = {\n\ttextUpdater: function (node, value) {\n\t\tnode.textContent = typeof value == 'undefined' ? '' : value;\n\t},\n\thtmlUpdater: function (node, value) {\n\t\tnode.innerHTML = typeof value == 'undefined' ? '' : value;\n\t},\n\tclassUpdater: function (node, value, oldValue) {\n\t\tlet className = node.className;\n\t\tclassName = className.replace(oldValue, '').replace(/\\s$/, '');\n\t\tlet space = className && String(value) ? ' ' : '';\n\t\tnode.className = className + space + value;\n\t},\n\tmodelUpdater: function (node, value, oldValue) {\n\t\tnode.value = typeof value == 'undefined' ? '' : value;\n\t},\n};\n","export function isUndef(v) {\n    return v === undefined || v === null;\n}\n\nexport function isDef(v) {\n    return v !== undefined && v !== null;\n}\n\nexport function isTrue(v) {\n    return v === true;\n}\n\nexport function isFalse(v) {\n    return v === false;\n}\n","import { isDef } from \"../shared/utils\";\n\nfunction Vnode(tag, data, children, text, element) {\n    this.tag = tag; // 标签名\n    this.data = data; // 存储节点的属性，class，style 等\n    this.children = children; // 子元素\n    this.text = text; // 文本内容\n    this.element = element; // Dom 节点\n    this.isStatic = false; // 是否静态节点\n    this.isComment = false; // 是否注释节点\n    this.key = data && data.key;\n    this.componentInstance = undefined;\n}\n\nexport function createVnode(tag, data, children) {\n    return new Vnode(tag, data, normalizeChildren(children), undefined, undefined);\n}\n\nexport function createTextNode(val) {\n    return new Vnode(undefined, undefined, undefined, String(val));\n}\n\nexport function emptyNodeAt(elm) {\n    return new Vnode(elm.tagName.toLowerCase(), {}, [], undefined, elm);\n}\n\n// 生成VNode 的时候，并不存在真实 DOM,element 会在需要创建DOM 时完成赋值，具体函数在 createElement 中\nexport function createElement(vnode) {\n    if (!vnode) return;\n    const { tag, data, children } = vnode;\n    // tag是正常html标签\n    if (tag) {\n        vnode.element = document.createElement(tag);\n        if (data.attrs) {\n            for (let key in data.attrs) {\n                vnode.element.setAttribute(key, data.attrs[key]);\n            }\n        }\n        if (children) {\n            createChildren(vnode, children);\n        }\n    } else {\n        vnode.element = document.createTextNode(vnode.text);\n    }\n    return vnode.element;\n}\n\nfunction normalizeChildren(children) {\n    if (typeof children === \"string\") {\n        return [createTextNode(children)];\n    }\n    return children;\n}\n\nfunction createChildren(vnode, children) {\n    const l = children.length;\n    for (let index = 0; index < l; index++) {\n        vnode.element.appendChild(createElement(children[index]));\n    }\n}\n\nexport function sameVnode(vnode1, vnode2) {\n    return (\n        vnode1.key === vnode2.key &&\n        vnode1.tag === vnode2.tag &&\n        vnode1.isComment === vnode2.isComment &&\n        isDef(vnode1.data) &&\n        isDef(vnode2.data)\n    );\n}\n","import { emptyNodeAt, createElement, sameVnode } from \"./vnode\";\nimport { isUndef, isDef, isTrue } from \"../shared/utils\";\n\nconst hooks = [\"create\", \"activate\", \"update\", \"remove\", \"destroy\"];\nconst cbs = [];\n\nexport function patch(oldVnode, vnode) {\n    // 当新节点不存在\n    if (isUndef(vnode)) {\n        if (isDef(oldVnode)) {\n            invokeDestroyHook(oldVnode);\n        }\n        return;\n    }\n\n    // 当旧节点不存在,直接插入新节点\n    if (isUndef(oldVnode)) {\n        createElement(vnode);\n    } else {\n        const isRealElement = isDef(oldVnode.nodeType);\n        if (!isRealElement && sameVnode(oldVnode, vnode)) {\n            // 都为虚拟节点且同类型\n            patchVnode(oldVnode, vnode);\n        } else {\n            if (isRealElement) {\n                oldVnode = emptyNodeAt(oldVnode);\n            }\n            const element = oldVnode.element;\n            const parent = element.parentNode;\n\n            if (parent) {\n                createElement(vnode);\n                parent.insertBefore(vnode.element, element);\n                parent.removeChild(element);\n            }\n        }\n    }\n}\n\nexport function patchVnode(oldVnode, vnode) {\n    // 当新旧节点完全相同\n    if (oldVnode === vnode) {\n        return;\n    }\n\n    const element = (vnode.element = oldVnode.element);\n\n    if (isTrue(oldVnode) && isTrue(vnode) && vnode.key === oldVnode.key) {\n        vnode.componentInstance = oldVnode.componentInstance;\n        return;\n    }\n\n    console.log(\"vnode :>> \", vnode);\n    if (isUndef(vnode.text)) {\n        if (isDef(oldVnode.children) && isDef(vnode.children)) {\n            if (oldVnode.children !== vnode.children) {\n                updateChildren(element, oldVnode.children, vnode.children);\n            }\n        } else if (isDef(vnode.children)) {\n            if (isDef(oldVnode.text)) {\n                element.textConent = \"\";\n            }\n            addVnodes(element);\n        } else if (isDef(oldVnode.children)) {\n            removeVnodes(element);\n        } else if (isDef(oldVnode.text)) {\n            element.textConent = \"\";\n        }\n    } else {\n        // 新旧节点上的文本节点不一致，更新新节点上的 DOM\n        element.textContent = vnode.text;\n    }\n}\n\nexport function updateChildren(parentElement, oldChild, newChild) {\n    let newStartIndex = 0;\n    let newEndIndex = newChild.length - 1;\n    let newStartVnode = newChild[newStartIndex];\n    let newEndVnode = newChild[newEndIndex];\n    let oldStartIndex = 0;\n    let oldEndIndex = oldChild.length - 1;\n    let oldStartVnode = oldChild[oldStartIndex];\n    let oldEndVnode = oldChild[oldEndIndex];\n\n    while (newStartIndex <= newEndIndex && oldStartIndex <= oldEndIndex) {\n        if (isUndef(oldStartVnode)) {\n            oldStartVnode = oldChild[++oldStartIndex];\n        } else if (isUndef(oldEndVnode)) {\n            oldEndVnode = oldChild[--oldEndIndex];\n        } else if (sameVnode(oldStartVnode, newStartVnode)) {\n            patchVnode(oldStartVnode, newStartVnode);\n            oldStartVnode = oldChild[++oldStartIndex];\n            newStartVnode = newChild[++newStartIndex];\n        } else if (sameVnode(oldEndVnode, newEndVnode)) {\n            patchVnode(oldEndVnode, newEndVnode);\n            oldEndVnode = oldChild[--oldEndIndex];\n            newEndVnode = newChild[--newEndIndex];\n        } else if (sameVnode(oldStartVnode, newEndVnode)) {\n            patchVnode(oldStartVnode, newEndVnode);\n            parentElement.insertBefore(oldStartVnode.element, oldEndVnode.element.nextSibling());\n            oldStartVnode = oldChild[++oldStartIndex];\n            newEndVnode = newChild[--newEndIndex];\n        } else if (sameVnode(oldEndVnode, newStartVnode)) {\n            patchVnode(oldEndVnode, newStartVnode);\n            parentElement.insertBefore(oldEndVnode.element, oldStartVnode.element);\n            oldEndVnode = oldChild[--oldEndIndex];\n            newStartVnode = newChild[++newStartIndex];\n        } else {\n            createElement(newStartVnode);\n            newStartVnode = newChild[++newStartIndex];\n        }\n    }\n}\n\nfunction addVnodes(element) {\n    return createElement(element);\n}\nfunction removeVnodes() {}\nfunction invokeDestroyHook(vnode) {}\n","import { observer } from \"./observer\";\nimport { Compile } from \"./compile\";\nimport { Watcher } from \"./watcher\";\nimport { Dep } from \"./dep\";\nimport { patch } from \"./vdom/patch\";\n\nexport class EVue {\n    constructor(options) {\n        this.options = options || {};\n        this.data = options.data;\n        this.el = options.el || \"body\";\n        this.__patch__ = patch;\n        this.patch = patch;\n        this.initState(); // 初始化data,method,computed,watch\n        this.$mount(document.getElementById(\"render\"));\n        callHook(this, \"beforeMount\");\n        this._isMounted = true;\n        this.$compile = new Compile(this.el, this);\n        callHook(this, \"mounted\");\n    }\n\n    initState() {\n        const vm = this;\n        const ops = vm.options;\n        this.initLifecycle(vm);\n        callHook(vm, \"beforeCreate\");\n        ops.data && vm.initData();\n        ops.methods && vm.initMethods();\n        ops.computed && vm.initComputed();\n        callHook(vm, \"created\");\n    }\n    initData() {\n        const vm = this;\n        const data = vm.options.data;\n        // 通过Object.defineProperty 实现 vm.xxx -> vm._data.xxx\n        Object.keys(data).forEach(function (key) {\n            vm.$proxyData(key);\n        });\n        observer(this.data);\n    }\n    initMethods() {\n        const vm = this;\n        const methods = vm.options.methods;\n        for (let key in methods) {\n            vm[key] = methods[key].bind(vm);\n        }\n    }\n    initComputed() {\n        const vm = this;\n        const computed = vm.options.computed;\n        for (let key in computed) {\n            const userDef = computed[key]; // 获取用户定义的属性\n            vm.defineComputed(vm, key, userDef);\n        }\n    }\n    defineComputed(vm, key, userDef) {\n        const def = { enumerable: true, configurable: true };\n        def.get = makeComputedGetter(userDef, vm);\n        def.set = userDef.set ? userDef.set : function () {};\n        Object.defineProperty(vm, key, def);\n    }\n    initLifecycle(vm) {\n        vm._isMounted = false;\n        vm._isDestroyed = false;\n        vm._isBeingDestroyed = false;\n    }\n    $mount(element) {\n        const vm = this;\n        const vnode = vm.render();\n        vm.$el = element;\n        vm.update(vnode);\n    }\n    update(vnode) {\n        const vm = this;\n        const prevVnode = vm._vnode;\n        vm._vnode = vnode;\n        vm._isMounted && callHook(vm, \"beforeUpdate\");\n\n        if (!prevVnode) {\n            // 第一次将vue实例挂载到dom节点\n            vm.$el = vm.__patch__(vm.$el, vnode);\n        } else {\n            // 节点的更新，diff的起点\n            vm.$el = vm.__patch__(prevVnode, vnode);\n        }\n        callHook(vm, \"updated\");\n    }\n    $destroy() {\n        callHook(vm, \"beforeDestroy\");\n        vm._isBeingDestroyed = true;\n        vm._isDestroyed = true;\n        callHook(vm, \"destroyed\");\n    }\n    render() {\n        const vm = this;\n        return vm.options.render.call(vm);\n    }\n    $watch(key, cb, options) {\n        new Watcher(this, key, cb);\n    }\n    $proxyData(key) {\n        const vm = this;\n        Object.defineProperty(vm, key, {\n            configurable: false,\n            enumerable: true,\n            get: function () {\n                return vm.data[key];\n            },\n            set: function (newVal) {\n                vm.data[key] = newVal;\n            },\n        });\n    }\n}\n\nfunction makeComputedGetter(getter, vm) {\n    const watcher = new Watcher(vm, getter, function () {}, { lazy: true });\n    return function computedGetter() {\n        // 缓存控制\n        if (watcher.dirty) {\n            watcher.evaluate();\n        }\n\n        if (Dep.target) {\n            watcher.depend();\n        }\n        return watcher.value;\n    };\n}\n\nfunction callHook(vm, hook) {\n    const handlers = vm.options[hook];\n    handlers && handlers.call(vm);\n}\n","import { EVue } from \"./src/evue\";\nimport { createVnode } from \"./src/vdom/vnode\";\n\nEVue.createVnode = createVnode;\nEVue.version = \"1.0.1\";\n\nexport default EVue;\n"],"names":["depid","Dep","constructor","options","id","key","subs","addSub","watcherInstance","push","removeSub","indexOf","splice","index","depend","target","addDep","notify","slice","forEach","sub","update","observer","data","Observer","walk","Object","entries","value","convert","val","defineReactive","dep","defineProperty","enumerable","configurable","get","set","newValue","Watcher","vm","expOrFn","cb","lazy","dirty","depIds","deps","getter","parseGetter","trim","undefined","oldValue","call","hasOwnProperty","i","length","evaluate","exp","test","exps","split","obj","len","Compile","el","$vm","$el","nodeType","document","querySelector","$fragment","nodeToFragment","compile","appendChild","fragment","createDocumentFragment","child","firstChild","childNodes","_this","Array","prototype","node","text","textContent","reg","compileElement","compileUtil","RegExp","$1","element","attrs","attributes","attr","attrName","name","attrValue","dir","substring","eventHandler","removeAttribute","bind","html","model","_getVMVal","addEventListener","e","_setVMVal","class","updaterFn","updater","eventType","fn","methods","k","textUpdater","htmlUpdater","innerHTML","classUpdater","className","replace","space","String","modelUpdater","isUndef","v","isDef","isTrue","Vnode","tag","children","isStatic","isComment","componentInstance","createVnode","normalizeChildren","createTextNode","emptyNodeAt","elm","tagName","toLowerCase","createElement","vnode","setAttribute","createChildren","l","sameVnode","vnode1","vnode2","patch","oldVnode","isRealElement","patchVnode","parent","parentNode","insertBefore","removeChild","console","log","updateChildren","textConent","addVnodes","parentElement","oldChild","newChild","newStartIndex","newEndIndex","newStartVnode","newEndVnode","oldStartIndex","oldEndIndex","oldStartVnode","oldEndVnode","nextSibling","EVue","__patch__","initState","$mount","getElementById","callHook","_isMounted","$compile","ops","initLifecycle","initData","initMethods","computed","initComputed","keys","$proxyData","userDef","defineComputed","def","makeComputedGetter","_isDestroyed","_isBeingDestroyed","render","prevVnode","_vnode","$destroy","$watch","newVal","watcher","computedGetter","hook","handlers","version"],"mappings":"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"}